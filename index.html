<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>نظام التاجر الذكي</title>

<style>
body{
    margin:0;
    font-family:Arial;
    direction:rtl;
    background:#f4f6f9;
}

.sidebar{
    width:220px;
    height:100vh;
    background:#1e2a38;
    color:white;
    position:fixed;
    padding:20px;
}

.sidebar h2{
    text-align:center;
}

.sidebar button{
    width:100%;
    padding:10px;
    margin:10px 0;
    background:#2f4054;
    color:white;
    border:none;
    cursor:pointer;
}

.sidebar button:hover{
    background:#3c556f;
}

.content{
    margin-right:240px;
    padding:20px;
}

.card{
    background:white;
    padding:20px;
    margin-bottom:20px;
    border-radius:8px;
    box-shadow:0 2px 5px rgba(0,0,0,0.1);
}

input, select{
    padding:8px;
    margin:5px;
}

button.primary{
    background:#007bff;
    color:white;
    border:none;
    padding:8px 15px;
    cursor:pointer;
}

.stat{
    font-size:18px;
    margin:10px 0;
}
</style>
</head>

<body>

<div class="sidebar">
    <h2>التاجر الذكي</h2>
    <button onclick="showPage('dashboard')">لوحة التحكم</button>
    <button onclick="showPage('sales')">المبيعات</button>
    <button onclick="showPage('inventory')">المخزون</button>
    <button onclick="showPage('expenses')">المصاريف</button>
</div>

<div class="content">

    <!-- لوحة التحكم -->
    <div id="dashboard" class="page">
        <div class="card">
            <h3>لوحة التحكم</h3>
            <div class="stat">إجمالي المبيعات: <span id="totalSales">0</span></div>
            <div class="stat">إجمالي المصاريف: <span id="totalExpenses">0</span></div>
            <div class="stat">صافي الربح: <span id="netProfit">0</span></div>
        </div>
    </div>

    <!-- المبيعات -->
    <div id="sales" class="page" style="display:none">
        <div class="card">
            <h3>إضافة عملية بيع</h3>
            <select id="saleProduct"></select>
            <input type="number" id="saleQty" placeholder="الكمية">
            <button class="primary" onclick="addSale()">إضافة</button>
        </div>
    </div>

    <!-- المخزون -->
    <div id="inventory" class="page" style="display:none">
        <div class="card">
            <h3>إضافة منتج</h3>
            <input type="text" id="productName" placeholder="اسم المنتج">
            <input type="number" id="buyPrice" placeholder="سعر الشراء">
            <input type="number" id="sellPrice" placeholder="سعر البيع">
            <input type="number" id="quantity" placeholder="الكمية">
            <button class="primary" onclick="addProduct()">إضافة</button>
        </div>
    </div>

    <!-- المصاريف -->
    <div id="expenses" class="page" style="display:none">
        <div class="card">
            <h3>إضافة مصروف</h3>
            <input type="text" id="expenseName" placeholder="اسم المصروف">
            <input type="number" id="expenseAmount" placeholder="المبلغ">
            <button class="primary" onclick="addExpense()">إضافة</button>
        </div>
    </div>

</div>

<script>

let products = JSON.parse(localStorage.getItem("products")) || [];
let sales = JSON.parse(localStorage.getItem("sales")) || [];
let expenses = JSON.parse(localStorage.getItem("expenses")) || [];

function saveData(){
    localStorage.setItem("products", JSON.stringify(products));
    localStorage.setItem("sales", JSON.stringify(sales));
    localStorage.setItem("expenses", JSON.stringify(expenses));
    updateDashboard();
    loadProducts();
}

function showPage(page){
    document.querySelectorAll(".page").forEach(p => p.style.display="none");
    document.getElementById(page).style.display="block";
}

function addProduct(){
    let name = document.getElementById("productName").value;
    let buy = parseFloat(document.getElementById("buyPrice").value);
    let sell = parseFloat(document.getElementById("sellPrice").value);
    let qty = parseInt(document.getElementById("quantity").value);

    products.push({name,buy,sell,qty});
    saveData();
    alert("تمت إضافة المنتج");
}

function loadProducts(){
    let select = document.getElementById("saleProduct");
    select.innerHTML = "";
    products.forEach((p,i)=>{
        select.innerHTML += `<option value="${i}">${p.name} (المتوفر: ${p.qty})</option>`;
    });
}

function addSale(){
    let index = document.getElementById("saleProduct").value;
    let qty = parseInt(document.getElementById("saleQty").value);

    if(products[index].qty < qty){
        alert("الكمية غير كافية في المخزون");
        return;
    }

    products[index].qty -= qty;
    let total = qty * products[index].sell;
    sales.push({product:products[index].name,total});
    saveData();
    alert("تم تسجيل البيع");
}

function addExpense(){
    let name = document.getElementById("expenseName").value;
    let amount = parseFloat(document.getElementById("expenseAmount").value);

    expenses.push({name,amount});
    saveData();
    alert("تم تسجيل المصروف");
}

function updateDashboard(){
    let totalSales = sales.reduce((sum,s)=> sum + s.total,0);
    let totalExpenses = expenses.reduce((sum,e)=> sum + e.amount,0);
    let net = totalSales - totalExpenses;

    document.getElementById("totalSales").innerText = totalSales;
    document.getElementById("totalExpenses").innerText = totalExpenses;
    document.getElementById("netProfit").innerText = net;
}

loadProducts();
updateDashboard();

</script>

</body>
</html>